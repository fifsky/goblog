{{ define "admin/cates" }}
{{ template "layout/header" . }}
<div id="cates" class="admin">
    {{ template "layout/admin_tabs" . }}
    <div id="content" class="clearfix">
        <h2>管理分类</h2>
        <div class="col-left">
            <form class="nf" action="/admin/cates" method="post" autocomplete="off">
                <div class="operate clearfix">
                    <div class="fl">
                        <a href="#">全选</a><span class="line">|</span><a href="#">反选</a>&nbsp;&nbsp;
                        <select name="gender" value="男">
                            <option value="男" selected>批量操作</option>
                            <option value="女">女</option>
                        </select>
                    </div>
                </div>

                <table class="list">
                    <tbody>
                    <tr>
                        <th width="20">&nbsp;</th>
                        <th>分类名</th>
                        <th width="60">缩略名</th>
                        <th width="50">文章数</th>
                        <th width="80">操作</th>
                    </tr>
                    <?php if(!$data['rs']){?>
                    <tr>
                        <td colspan="5" align="center">还没有分类！</td>
                    </tr>
                    <?php }else{?>
                    <?php foreach($data['rs'] as $v){?>
                    <tr>
                        <td><input type="checkbox" name="ids" value="<?php echo $v['cate_id'];?>"/></td>
                        <td><a href="<?php echo get_url('categroy/'.($v['cate_domain'] ? $v['cate_domain'] : $v['cate_id']));?>"><?php echo $v['cate_name'];?></a></td>
                        <td><a href="<?php echo get_url('categroy/'.($v['cate_domain'] ? $v['cate_domain'] : $v['cate_id']));?>"><?php echo $v['cate_domain'];?></a></td>
                        <td class="art-num"><a href="<?php echo get_url('categroy/'.($v['cate_domain'] ? $v['cate_domain'] : $v['cate_id']));?>"><?php echo $v['post_count'] ? $v['post_count'] : 0;?></a></td>
                        <td><a href="<?php echo get_url('admin/cates',array('cate_id'=>$v['cate_id']));?>">编辑</a><?php if($v['cate_id'] != 1){?><span class="line">|</span><a href="<?php echo get_url('post/cate_delete',array('cate_id'=>$v['cate_id']));?>" rel="confirmTodo" title="确定要删除该分类？">删除</a><?php }?></td>
                    </tr>
                    <?php }?>
                    <?php }?>
                    </tbody>
                </table>
                <div class="operate clearfix">
                    <div class="fl">
                        <a href="#">全选</a><span class="line">|</span><a href="#">反选</a>&nbsp;&nbsp;
                        <select name="gender" value="男">
                            <option value="男" selected>批量操作</option>
                            <option value="女">女</option>
                        </select>
                    </div>
                    {{ template "layout/pagination" . }}
                </div>
            </form>
        </div>
        <div class="col-right">
            <form id="cate_form" class="vf" action="<?php echo get_url('save/cate');?>" method="post" autocomplete="off">
                <p><label class="label_input">分类名称</label>
                    <input type="hidden" name="cate_id" value="<?php echo ifset($cate_info,'cate_id');?>"/>
                    <input type="text" class="input_text" size="30" name="cate_name" value="<?php echo ifset($cate_info,'cate_name');?>"/></p>

                <p><label class="label_input" >分类缩略名</label>
                    <input type="text" class="input_text" size="30" name="cate_domain" value="<?php echo ifset($cate_info,'cate_domain');?>"/>
                    <span class="hint">缩略名是在 URL 中使用的别称，它可以令 URL 更美观。建议使用字母,数字,下划线和横杠。</span>
                </p>
                <p>
                    <label class="label_input" >分类描述</label>
                    <textarea name="cate_desc" rows="5" cols="30"><?php echo ifset($cate_info,'cate_desc');?></textarea>
                    <span class="hint">描述将在分类meta中显示</span>
                </p>

                <p class="act"><input class="formbutton" type="submit" value="<?php echo isset($cate_info['cate_id']) ? '修改' : '添加';?>"></p>
            </form>
        </div>
    </div>
</div>
<script type="text/javascript">
    $('#cate_form').submit(function(){
        var ok = true;

        var $el = $('input[name="cate_name"]');
        if($.trim($el.val()) == ''){
            $el.focus().closest('p').addClass('error');
            ok = false;
        }

        return ok;
    });
</script>
{{ template "layout/footer" . }}
{{ end }}